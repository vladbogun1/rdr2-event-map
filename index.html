<!doctype html>
<html lang="uk">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ForgeRP –ú–∞–ø–∞ –ø–æ–¥—ñ—ó ‚Äî —è–ª–∏–Ω–∫–∏</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script>
        (async () => {
          try {
            const res = await fetch("./version.json?t=" + Date.now(), { cache: "no-store" });
            const { v } = await res.json();
            if (!v) return;
            const links = document.querySelectorAll('link[rel="stylesheet"][href^="./"]');
            links.forEach(l => {
              const u = new URL(l.getAttribute("href"), location.href);
              u.searchParams.set("v", v);
              l.href = u.toString();
            });
            localStorage.setItem("forgerp_asset_version", v);
          } catch {}
        })();
    </script>

    <link rel="stylesheet" href="./theme.css">

</head>
<body class="page">
<header>
    <div class="header-row">
        <div class="title">ü™µ ForgeRP –ú–∞–ø–∞ –ø–æ–¥—ñ—ó ‚Äî —è–ª–∏–Ω–∫–∏</div>
        <div class="created">
            Created By:
            <a href="https://t.me/p_lastelin" target="_blank" rel="noopener">@v_lastelin</a>
            <button id="refreshBtn" class="hdr-btn" type="button">–û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</button>
        </div>
    </div>
</header>

<div class="map-shell">
    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    (async () => {
      const getV = async () => {
        try {
          const r = await fetch("./version.json?t=" + Date.now(), { cache: "no-store" });
          const j = await r.json();
          return j.v || "1";
        } catch {
          return "1";
        }
      };

      const v = await getV();

      const load = (src) => new Promise((ok, bad) => {
        const s = document.createElement("script");
        s.src = src + (src.includes("?") ? "&" : "?") + "v=" + encodeURIComponent(v);
        s.onload = ok;
        s.onerror = bad;
        document.body.appendChild(s);
      });

      await load("./map-settings.js");
      await load("./map-zoom.js");
      await load("./app.js");
    })();
</script>
</body>
</html>
